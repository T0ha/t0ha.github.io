---
layout: post
title: "FAQ: How to connect PGAdmin4 to DB through SSH tunnel with Public key authentication"
tag:
  - pgadmin
  - faq
  - ssh-keys
  - postgres
  - ssh-tunnel
status: copy
categories:
  - en
  - faq
  - software
---

<figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*cT9EvJO_O_Qg1GmpsBPskA.png" /></figure><p>This post is inspired by my clients who asks me this question very often. At first, I was surprised by this question. I use <a href="https://tableplus.com/">TablePlus</a> and it is an easy journey to configure connection in it . But after I tried with PGAdmin I realised that there was a real issue with it. In this article I’m going to describe the complete process and point my readers to pain points of it.</p><h3><strong>Step 1: Generate public keys for SSH connection</strong></h3><p>At first glance, generating ssh public key looks trivial. But as I discovered PGAdmin 4 doesn’t support all key formats. I’ve never had issue with my key, because it was generated rather long time ago.</p><p>But my clients had. I usually ask them to follow <a href="https://help.github.com/en/articles/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent">tutorial by GitHub.</a> But lastly they accidentally began to get the error from PGAdmin as in the picture below.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/607/1*uZbmNfBA3FCaiqqX2_B1ZQ.png" /></figure><p>As I’m a curious person, I decided to discover the issue. As a result of my small investigation I found that <em>ssh-keygen</em> switched to the new key output format. This format was not supported correctly by PGAdmin. Some time ago when I was generating my key pair <em>ssh-keygen</em> was generating key in PEM format by default. But nowadays things changed and the key default format is RFC4716.</p><p>So I recommend you to generate key pair with the following command:</p><pre> ssh-keygen -t rsa -m PEM -b 4096</pre><p>Here</p><ul><li><strong>-m PEM</strong> is the most critical part that sets the key output format,</li><li><strong>-b 4096</strong> is the length of the key,</li><li><strong>-t rsa</strong> is the crypto-algorithm used for key pair generation.</li></ul><p>During the process the utility asks you to type path to store the key in and your password twice.<strong> I strongly suggest you to set the password</strong> as it adds security for your key pair.</p><p>Now you have your key pair ready. Send it (file that has “pub” extension or text from it) to admin of the server you want to connect to. He will add it to your authorised keys on the server.</p><p><strong>Never share your private key (one without “.pub” extension) with anyone!</strong></p><p>After your key is there try to connect to the server with ssh. It should look like this:</p><pre> ssh -i /path/to/your/private_rsa -o IdentitiesOnly=yes user@server</pre><p>If it connects, you are ok, disconnect and let’s go forward, if not ask your admin for help.</p><h3><strong>Step2: Configure PGAdmin4</strong></h3><p>Start PGAdmin. Then click on “<strong>Servers</strong>” in the “<strong>Browser</strong>” at the left. After that, go to “<strong>Object</strong>” -&gt; “<strong>Create</strong>” -&gt; “<strong>Server</strong>” in navigation menu at the top. If you follow me correct, you’ll see the window as in the image below.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/504/1*FFJ7WLR8yVx8NN76jrMKBw.png" /></figure><p>Input the name of the connection which you want to see in server tree into “<strong>Name</strong>” field. All the rest fields could be left as is if you don’t know what you are doing.</p><h4>Switch to “Connection” tab.</h4><figure><img alt="" src="https://cdn-images-1.medium.com/max/510/1*3FqutjD8ArOYUHYUd_CVlw.png" /></figure><p>Here you need to input you DB connection data. As you tunnel your connection, the “<strong>Hostname</strong>” field should be either “localhost” or “127.0.0.1”. “<strong>Port</strong>”, “<strong>username</strong>”, “<strong>password</strong>” and “<strong>Maintenance database</strong>” fields depend on your exact DB connection settings and should be provided by DB admin.</p><h4>Switch to “SSH Tunnel” tab.</h4><p>Here you need to enable “<strong>Use SSH tunneling</strong>” and switch “<strong>Authentication</strong>” to “<strong>Identity file</strong>”.</p><p>Put your server IP or hostname into “<strong>Tunnel host</strong>” field. “<strong>Tunnel port</strong>” is usually as default if your admin haven’t mentioned it for you. “<strong>Username</strong>” field is your ssh username (those you used when tested ssh connections in previous step).</p><p>Push “<strong>…</strong>” button to the right of “<strong>Identity file</strong>” field. Choose your private key file (one without “.pub” extension). Or you can type path to the file into “<strong>Identity file</strong>” field by hand.</p><p>Enter password for your key into “<strong>Password</strong>” field and check “<strong>Save password?</strong>” checkbox if you are ok with saving your password by PGAdmin4.</p><p>Click the “<strong>Save</strong>” button and if it connects correctly you are done.</p><h4>PS</h4><p>Dear readers, thank you for your interest and feedback. You are welcome to support this article by clapping, subscribing to the publication or following <a href="http://twitter.com/T0ha666">@T0ha666</a>.</p><p>Do you have a tech startup idea? Or do you need some help with web, mobile or IoT programming?</p><p>Visit <a href="https://3epsilon.pro?utm_source=medium&amp;utm_medium=post&amp;utm_compaign=footer&amp;utm_content=b351750c20be">3∑ website</a> and get a great offer from us.</p><p>You can contact me by Email (<a href="mailto:t0hashvein@gmail.com">t0hashvein@gmail.com</a>), Twitter (<a href="http://twitter.com/t0ha666">@t0ha666</a>), Reddit (/u/t0ha) or Telegram (t.me/war1and).<br>See you next time…</p><img src="https://medium.com/_/stat?event=post.clientViewed&referrerSource=full_rss&postId=b351750c20be" width="1" height="1" alt=""><hr><p><a href="https://medium.com/3-elm-erlang-elixir/faq-how-to-connect-pgadmin4-to-db-through-ssh-tunnel-with-public-key-authentication-b351750c20be">FAQ: How to connect PGAdmin4 to DB through SSH tunnel with Public key authentication</a> was originally published in <a href="https://medium.com/3-elm-erlang-elixir">3∑: Elm, Erlang &amp; Elixir</a> on Medium, where people are continuing the conversation by highlighting and responding to this story.</p>
